â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš¨ Ğ¡Ğ ĞĞ§ĞĞ: Next.js ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ ÑƒĞ±Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ (Killed)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ:
  nextjs_app  | Killed
  nginx_proxy  | 502 Bad Gateway
  
ĞŸĞ Ğ˜Ğ§Ğ˜ĞĞ:
  OOM Killer ÑƒĞ±Ğ¸Ğ²Ğ°ĞµÑ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ - ĞĞ• Ğ¥Ğ’ĞĞ¢ĞĞ•Ğ¢ ĞŸĞĞœĞ¯Ğ¢Ğ˜!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Ğ Ğ•Ğ¨Ğ•ĞĞ˜Ğ•: Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ memory limit Ğ´Ğ¾ 3GB

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ Ğ‘Ğ«Ğ¡Ğ¢Ğ Ğ«Ğ• ĞšĞĞœĞĞĞ”Ğ« (Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ):

1. ĞĞĞ™Ğ”Ğ˜Ğ¢Ğ• docker-compose.yml:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   find ~ -name "docker-compose.yml" 2>/dev/null
   # Ğ˜Ğ»Ğ¸
   find /opt -name "docker-compose.yml" 2>/dev/null

2. ĞĞ¢Ğ Ğ•Ğ”ĞĞšĞ¢Ğ˜Ğ Ğ£Ğ™Ğ¢Ğ• (Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ² ÑĞµĞºÑ†Ğ¸Ñ nextjs/web):
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   nano /path/to/docker-compose.yml
   
   # Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ:
   deploy:
     resources:
       limits:
         memory: 3G
   environment:
     - NODE_OPTIONS=--max-old-space-size=2048

3. ĞŸĞ Ğ˜ĞœĞ•ĞĞ˜Ğ¢Ğ•:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   cd /path/to/docker-compose/
   docker-compose down
   docker-compose up -d

4. ĞŸĞ ĞĞ’Ğ•Ğ Ğ¬Ğ¢Ğ•:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   docker stats nextjs_app
   
   # Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ:
   # MEM USAGE / LIMIT
   # 450MiB / 3GiB âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ĞŸĞĞ§Ğ•ĞœĞ£ 3GB?

  Next.js base:         ~500MB
  FormData parse:       ~1000MB (Ğ´Ğ»Ñ 650MB Ñ„Ğ°Ğ¹Ğ»Ğ°)
  Streaming:            ~100MB
  Ğ ĞµĞ·ĞµÑ€Ğ²:               ~500MB
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Ğ˜Ğ¢ĞĞ“Ğ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼:        ~2-3GB

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ†˜ Ğ•Ğ¡Ğ›Ğ˜ ĞĞ•Ğ¢ docker-compose.yml:

  # ĞŸĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ:
  docker stop nextjs_app
  docker rm nextjs_app
  
  docker run -d \
    --name nextjs_app \
    --memory=3g \
    --memory-swap=3g \
    -e NODE_OPTIONS='--max-old-space-size=2048' \
    -e NODE_ENV=production \
    -v /path/to/uploads:/app/public/uploads \
    -p 3000:3000 \
    --restart unless-stopped \
    your-image:latest

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ ĞĞ›Ğ¬Ğ¢Ğ•Ğ ĞĞĞ¢Ğ˜Ğ’Ğ (ĞµÑĞ»Ğ¸ Ğ½ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²):

  1. Ğ¡Ğ¾Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾ 650MB â†’ 200MB:
     ffmpeg -i input.mp4 -c:v libx264 -crf 23 \
       -preset medium -c:a aac -b:a 128k output.mp4
  
  2. Ğ˜Ğ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ²Ğ½ĞµÑˆĞ½ĞµĞµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ:
     - Cloudflare R2 (Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾ Ğ´Ğ¾ 10GB)
     - AWS S3
     - Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ URL Ğ² Ğ¿Ğ¾Ğ»Ğµ "URL Ğ²Ğ¸Ğ´ĞµĞ¾"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ĞŸĞĞ¡Ğ›Ğ• ĞŸĞ Ğ˜ĞœĞ•ĞĞ•ĞĞ˜Ğ¯:

  docker logs -f nextjs_app
  
  Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ:
  âœ… Uploaded: video.mp4 (652.00 MB)
  POST /api/upload 200
  
  Ğ‘Ğ•Ğ— ÑÑ‚Ñ€Ğ¾ĞºĞ¸ "Killed"!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ Ğ¤ĞĞ™Ğ›Ğ«:
  URGENT_OOM_KILLER_FIX.md         - Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ
  DOCKER_MEMORY_FIX_COMMANDS.sh    - Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑĞºÑ€Ğ¸Ğ¿Ñ‚
  docker-compose.recommended.yml   - Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ğ¼Ğ¸

Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡: âš ï¸ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ - Ğ¢Ğ Ğ•Ğ‘Ğ£Ğ•Ğ¢ Ğ¡Ğ ĞĞ§ĞĞĞ“Ğ ĞŸĞ Ğ˜ĞœĞ•ĞĞ•ĞĞ˜Ğ¯

